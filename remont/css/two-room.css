/* ===== two-room.css — страница "Ремонт двухкомнатной, 52 м²" ===== */

/* Фолбэк-токены (если brand/palette.css ещё не успел загрузиться) */
:root{
  --brand-600:#166534;
  --brand-500:#1a7a3e;
  --brand-400:#2da14e;
  --brand-accent:#70d009;
  --surface-d:#0f172a;
  --surface-d-2:#0b1220;
  --text-on-dark:#e5e7eb;
  --ring: color-mix(in oklab, var(--brand-600) 28%, #ffffff);
  --shadow: 0 .16rem .8rem rgba(0,0,0,.25);

  /* Слайдер/HUD */
  --hud-color:#fff;
  --bar-bg: color-mix(in oklch, #ffffff 25%, transparent);
  --bar-fg: var(--brand-accent);
  --bar-h: .25rem;
}

/* Скрываем бургер-меню на всех страницах, КРОМЕ главной (.page-index) */
body:not(.page-index) .site-header__burger,
body:not(.page-index) .nav-toggle,
body:not(.page-index) .site-header__burger-line {
    display: none !important;
}
/* База */
html{ scrollbar-gutter: stable both-edges; }
body.scroll-lock{ overflow:hidden; overscroll-behavior:none; }
main.case-page{ padding: 1.2rem 0; }
.content{ font-size: 1.25rem; line-height: 1.55; }

/* Заголовки секций */
.case-section-title{
  position: relative;
  margin: 1.2rem 0 .8rem;
  padding-block: .2rem;
  line-height: 1.2;
}
.case-section-title::after{
  content:"";
  display:block;
  height: .24rem;
  width: 6rem;
  margin-top: .4rem;
  border-radius: 999rem;
  background: linear-gradient(90deg, var(--brand-600), color-mix(in oklab, var(--brand-600) 55%, var(--brand-accent)));
}

/* Мета */
.case-meta{ margin-top: .8rem; }
.case-meta__row strong{ color: var(--brand-600); font-weight: 700; }
.case-meta__muted{ opacity: .85; }

/* Двухколоночный блок */
.case-two-col{ display:grid; gap: 1.6rem; }
@media (min-width: 56rem){ .case-two-col{ grid-template-columns: 1.2fr .8fr; } }

/* KPI */
.case-kpi{
  display:grid; gap:.8rem;
  grid-template-columns: repeat(2,minmax(0,1fr));
  margin:.8rem 0 1.2rem;
}
@media (min-width:48rem){ .case-kpi{ grid-template-columns: repeat(4,minmax(0,1fr)); } }
.kpi{
  padding:1.2rem; border-radius:1.2rem;
  color:var(--text-on-dark);
  background:
    radial-gradient(80rem 40rem at 110% -20%, color-mix(in oklab, var(--brand-accent) 18%, var(--surface-d)) 0%, transparent 55%),
    var(--surface-d);
  outline:.12rem solid color-mix(in oklab, var(--brand-600) 26%, transparent);
  box-shadow:var(--shadow);
}
.kpi strong{ font-size:1.2rem; display:block; }
.kpi small{ display:block; opacity:.88; margin-top:.2rem; }

/* Таймлайн */
.case-timeline{
  counter-reset: day;
  display:grid; gap:1rem; margin-top:.8rem;
}
.case-timeline .step{
  position:relative;
  color:var(--text-on-dark);
  background:var(--surface-d);
  border-radius:1rem;
  padding:1rem 1.2rem 1rem 1.4rem;
  box-shadow:var(--shadow);
  border-inline-start:.24rem solid var(--brand-600);
}
.case-timeline .step::before{
  counter-increment: day;
  content:"День " counter(day) " — ";
  font-weight:700; color:var(--brand-accent);
}

/* Материалы */
.material-list{
  columns:1; column-gap:2rem; margin-top:.6rem;
}
@media (min-width:56rem){ .material-list{ columns:2; } }
.material-list li{
  break-inside:avoid; list-style:none; position:relative;
  padding-left:1.4rem; margin:.4rem 0;
}
.material-list li::before{
  content:"";
  position:absolute; left:0; top:.6rem;
  width:.7rem; height:.7rem; border-radius:50%;
  background: radial-gradient(circle at 30% 30%, var(--brand-accent), var(--brand-600));
  box-shadow:0 0 0 .12rem color-mix(in oklab, var(--brand-600) 25%, transparent);
}

/* Галерея */
.case-gallery .case-grid{
  display:grid; gap:.6rem; grid-template-columns:1fr;
}
.case-gallery img{
  display:block; width:100%; height:auto;
  border-radius:.8rem;
  outline:.12rem solid color-mix(in oklab, var(--brand-600) 22%, transparent);
  transition: transform .2s ease, box-shadow .2s ease;
}
.case-gallery img[data-full]{ cursor: zoom-in; }
.case-gallery img[data-full]:hover{
  transform: translateY(-.08rem);
  box-shadow: 0 .4rem 1rem rgba(0,0,0,.18);
}

/* Видео-контейнер (если появится) */
.video-wrap{
  aspect-ratio:16/9; background:var(--surface-d-2);
  border-radius:1rem; overflow:hidden;
  outline:.14rem solid color-mix(in oklab, var(--brand-600) 28%, transparent);
  box-shadow:0 .4rem 1.2rem rgba(0,0,0,.35);
}
.video-wrap video{ width:100%; height:100%; display:block; }

/* ===== Слайдер (Сшитые кадры) ===== */
.slides{
  position:relative; border-radius:1rem; overflow:clip;
  box-shadow:0 .5rem 2rem rgba(0,0,0,.1); background:#0a0a0a; isolation:isolate;
}
.slides::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  background: radial-gradient(120% 80% at 50% 50%, rgba(0,0,0,0) 60%, rgba(0,0,0,.20) 100%);
  mix-blend-mode:multiply;
}
.slides__viewport{ position:relative; width:100%; aspect-ratio:16/9; }
.slide{
  position:absolute; inset:0; opacity:0; transform:scale(.98);
  transition:opacity .5s ease, transform .6s ease;
  display:grid; place-items:end; background:#111;
}
.slide.is-active{ opacity:1; transform:scale(1); }
.slide>img{
  position:absolute; inset:0; width:100%; height:100%;
  object-fit:cover; will-change: transform;
  backface-visibility:hidden; transform: translateZ(0) scale(1);
  transform-origin: 50% 50% .1px;
}
/* подпись */
.slide .slide__caption{
  position:relative; width:max(60%,20rem);
  margin:0 1rem 1rem; padding:.75rem 1rem; border-radius:.75rem;
  background:color-mix(in oklch,white 10%,transparent);
  -webkit-backdrop-filter: blur(6px); backdrop-filter: blur(6px);
  color:#fff; font:500 1rem/1.3 Manrope,system-ui;
  box-shadow:0 .5rem 1.5rem rgba(0,0,0,.25);
  transform: translateY(.5rem); opacity:.0;
}
.slide.is-active .slide__caption{
  opacity:1; transform: translateY(0);
  transition: transform .45s ease, opacity .45s ease .05s;
}
@media (prefers-color-scheme: dark){
  .slide .slide__caption{ background:color-mix(in oklch,black 40%,transparent); color:#f5f5f5; }
}

/* Навигация/точки — фиксируем «без дёрганий» на hover и прозрачный фон */
.slides__nav{
  position:absolute; top:50%; transform:translateY(-50%);
  z-index:2; width:3rem; height:3rem;
  border:.1rem solid rgba(255,255,255,.35);
  border-radius:.8rem;
  background: transparent; color:#fff;
  display:grid; place-items:center; cursor:pointer; opacity:.95;
  transition: opacity .15s ease, box-shadow .15s ease; /* БЕЗ translate/scale на hover */
  will-change: opacity;
}
.slides__nav:hover{ opacity:1; box-shadow:0 .25rem .75rem rgba(0,0,0,.25); }
.slides__nav--prev{ left:.75rem; }
.slides__nav--next{ right:.75rem; }

.slides__dots{
  position:absolute; left:50%; bottom:.75rem; transform:translateX(-50%);
  display:flex; gap:.5rem; z-index:2;
}
.dot{
  width:.625rem; height:.625rem; border-radius:999rem; border:0;
  background:color-mix(in oklch,white 50%,transparent);
  opacity:.6; cursor:pointer;
}
.dot.is-active{ width:1.5rem; opacity:1; background: var(--brand-accent); transition:width .25s ease; }

/* HUD и прогресс бар */
.slides__hud{
  position:absolute; top:.5rem; left:.75rem; z-index:3;
  display:flex; align-items:center; gap:.5rem;
  padding:.25rem .5rem; border-radius:.5rem;
  color:var(--hud-color); font:600 .875rem/1 Manrope,system-ui;
  background: color-mix(in oklch, black 35%, transparent);
  -webkit-backdrop-filter: blur(6px); backdrop-filter: blur(6px);
}
.hud__rec-dot{
  width:.5rem; height:.5rem; border-radius:50%;
  background:#ff3b30; box-shadow:0 0 .5rem rgba(255,59,48,.9);
  animation: recPulse 1.2s ease-in-out infinite;
}
@keyframes recPulse{ 0%,100%{ transform:scale(1); opacity:1 } 50%{ transform:scale(1.25); opacity:.6 } }
.slides[data-paused="true"] .hud__rec-dot{ animation-play-state: paused; opacity:.5; }

.slides__bar{
  position:absolute; left:.75rem; right:.75rem; bottom:.5rem; z-index:3;
  height:var(--bar-h);
  background: var(--bar-bg);
  border-radius:999rem; overflow:hidden;
  contain: layout paint; transform: translateZ(0);
}
.slides__bar-inner{
  height:100%; width:0%; background: var(--bar-fg);
  will-change: width;
}

/* FAQ */
.faq details{
  background: var(--surface-d); color: var(--text-on-dark);
  border-radius: 1rem; padding: .8rem 1rem;
  border: .1rem solid color-mix(in oklab, var(--brand-600) 18%, transparent);
  transition: border-color .2s ease;
}
.faq details + details{ margin-top: .8rem; }
.faq details[open]{ border-color: color-mix(in oklab, var(--brand-600) 45%, transparent); }
.faq summary{ cursor: pointer; }

/* CTA — контраст текста */
.case-cta--bottom{ text-align:center; margin-top:1.6rem; }
.case-cta .btn, .btn-cta-calc{
  color:#fff !important; text-shadow:0 .04rem .08rem rgba(0,0,0,.35);
}
.btn.btn--ghost{
  border-color: color-mix(in oklab, var(--brand-600) 45%, #fff);
  color: var(--brand-600) !important;
}
.btn.btn--ghost:hover{ background: color-mix(in oklab, var(--brand-accent) 12%, #fff); }

/* Бейдж */
.btn-badge{
  position:absolute; left:-.1rem; top:.1rem;
  padding:.25rem .5rem; border-radius:.5rem;
  background:#166534; color:#fff;
  font:700 .75rem/1 Manrope,system-ui;
  box-shadow:0 .15rem .4rem rgba(0,0,0,.2);
}

/* Визуально скрытое */
.visually-hidden{
  position:absolute !important; width:1px; height:1px;
  margin:-1px; padding:0; border:0; overflow:hidden;
  clip:rect(0 0 0 0); clip-path:inset(50%);
}

/* Светлая схема */
@media (prefers-color-scheme: light){
  .kpi,
  .case-timeline .step,
  .faq details{ color:#0b1220; background:#ffffff; }
  .video-wrap{ background:#f6f8fb; }
  .material-list li::before{
    box-shadow: 0 0 0 .12rem color-mix(in oklab, var(--brand-600) 18%, #ffffff);
  }
}

/* Доп. фиксы раскладки описания/галереи */
.case-body.case-two-col{ display:grid; gap:1.2rem; }
@media (min-width:56rem){
  .case-body.case-two-col{
    grid-template-columns: 2fr 1.5fr; align-items:start;
  }
}
.case-desc{ max-width: 80ch; }
.case-desc ul{ margin:.6rem 0 0 1.2rem; padding:0; }
.case-desc li{ margin:.35rem 0; }
.lightbox__caption{ margin-top:.4rem; font-size: 1.5rem; opacity:.8; }

/* Кнопка вверх */
.to-top{
  position:fixed; right:1rem; bottom:1rem; z-index:50;
  opacity:0; transition:opacity .2s ease;
  width:2.5rem; height:2.5rem; border-radius:.7rem;
  border:.1rem solid color-mix(in oklab, var(--brand-600) 40%, #fff);
  background:color-mix(in oklch, #ffffff 6%, transparent);
  -webkit-backdrop-filter: blur(6px); backdrop-filter: blur(6px);
}

/* внутри блока .case-body.case-two-col растягиваем элемент на обе колонки */
.case-body.case-two-col .span-all { grid-column: 1 / -1; }

/* на всякий случай: сетка самой секции */
.case-body.case-two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
@media (max-width: 1024px) { .case-body.case-two-col { grid-template-columns: 1fr; } }


/* Растяжка блока на всю ширину после галереи */
.case-body.case-two-col > .span-all { 
  grid-column: 1 / -1; 
}

/* На случай, если сетка не задана где-то выше */
.case-body.case-two-col{
  display:grid;
  gap:1.6rem;
}
@media (min-width:56rem){
  .case-body.case-two-col{
    grid-template-columns: 1.2fr .8fr;
  }
}


/* Галерея занимает обе колонки родителя (во всю ширину контейнера страницы) */
.case-body.case-two-col > .case-gallery{
  grid-column: 1 / -1;
  width: 100%;
}

/* 2 карточки в ряд на широких экранах, 1 в ряд на мобильных */
.case-gallery .case-grid{
  display: grid;
  gap: .8rem;
  grid-template-columns: repeat(2, minmax(0,1fr));
  width: 100%;
}
@media (max-width: 48rem){
  .case-gallery .case-grid{ grid-template-columns: 1fr; }
}

/* тех. правки, чтобы карточки растягивались и не вылазили */
.case-gallery .case-grid > *{ min-width: 0; }
.case-gallery .case-grid figure{ margin: 0; }
.case-gallery .case-grid img{ display:block; width:100%; height:auto; }

/* любой блок .span-all внутри .case-body.case-two-col растягивается на 2 колонки */
.case-body.case-two-col > .span-all{ grid-column: 1 / -1; }

/* на всякий: сетка описания/галереи */
.case-body.case-two-col{ display:grid; gap:1.6rem; }
@media (min-width:56rem){ .case-body.case-two-col{ grid-template-columns: 1.2fr .8fr; } }

/* Убеждаемся, что сетка задана */
  .case-two-col{display:grid;gap:1.5rem}
  @media (min-width: 960px){
    .case-two-col{grid-template-columns:minmax(0,1fr) minmax(0,1fr)}
  }

  /* Этот блок всегда тянем на всю ширину */
  .case-two-col > .span-all{
    grid-column: 1 / -1 !important;
    width: 100%;
  }
  
  .case-two-col { display: grid; gap: 1.5rem; }
    @media (min-width: 960px) {
      .case-two-col { grid-template-columns: minmax(0,1fr) minmax(0,1fr); }
    }
    /* Растягиваем служебный блок на две колонки */
    .case-two-col > .span-all { grid-column: 1 / -1 !important; width: 100%; }

    /* Галерея: 2 карточки в строку */
    .case-gallery .case-grid { display: grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 1rem; }
    .case-gallery figure { margin: 0; }
    .case-gallery img { width: 100%; height: auto; display: block; border-radius: 8px; }
    
    .case-page .case .case-body { display:block; width:100%; max-width:100%; }
    
    /* Локальные стили только для этой галереи */
    .case-gallery { margin-top: 1.25rem; }
    .case-gallery .case-grid{
      display:grid;
      grid-template-columns:repeat(2,minmax(0,1fr));
      gap:1rem;
      align-items:start;
    }
    @media (max-width: 768px){
      .case-gallery .case-grid{ grid-template-columns:1fr; }
    }

    .case-gallery figure{
      margin:0;
      display:flex;
      flex-direction:column;
      border-radius:12px;
      overflow:hidden;              /* скругление и обрезка внутри */
      background: #0b0b0b08;        /* лёгкий фон для загрузки */
    }
    .case-gallery figure > .media{
      position:relative;
      width:100%;
      /* Единая пропорция карточек — можно менять, напр. 4/3, 16/9, 1/1 */
      aspect-ratio: 3 / 2;
      overflow:hidden;
    }
    .case-gallery img{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;             /* без «вытягивания» */
      display:block;
    }
    .case-gallery figcaption{
      padding:.75rem 1rem;
      font-size:1.2rem;
      font-weight: 600;
      line-height:1.45;
      color: var(--muted-fg, #666);
      background: #fff0;
    }

    /* Подпись под галереей */
    .case-gallery .lightbox__caption{
      margin-top:.5rem;
      font-size: 1.5rem;
      color: var(--muted-fg, #777);
      text-align:center;
    }
    
    .scroll-top {
  position: fixed;
  bottom: 20px;
  right: 200px;
}

.scroll-top {
  background-color: rgba(255, 255, 255, 0.15);
  border-radius: 8px;
  backdrop-filter: blur(6px);
}
.scroll-top:hover {
  background-color: rgba(255, 255, 255, 0.25);
}

.scroll-top {
  transition: all 0.2s ease;
  cursor: pointer;
}
.scroll-top:hover {
  transform: translateY(-3px);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

.scroll-top {
  width: 48px;
  height: 48px;
}

.to-top {
    position: fixed;
    right: 10rem;
    bottom: .8rem;
    z-index: 2147483647;
    display: inline-flex
;
    align-items: center;
    justify-content: center;
    width: 4.2rem;
    height: 4.2rem;
    border: 0;
    border-radius: 50%;
    background: var(--brand, #16a34a);
    color: #fff;
    box-shadow: 0 .3rem 1rem rgba(0, 0, 0, .15);
    cursor: pointer;
    opacity: 0;
    pointer-events: none;
    transform: translateY(8px);
    transition: opacity .2s ease, transform .2s ease;
}


/* Подпись под галереей */
    .case-gallery .lightbox__caption{
      margin-top:.5rem;
      font-size: 1.3rem;
      color: var(--muted-fg, #777);
      text-align:center;
}

.lightbox__caption{ margin-top:.4rem; font-size: 1.3rem; opacity:.8; }

/* === Контрастные улучшения для Lighthouse === */
.btn--ghost {
  color: #0f4d23;
  border-color: color-mix(in oklch, #0f4d23 60%, black);
}

.btn-badge {
  background-color: #6ba62f; /* повышен контраст */
  color: #fff;
}

.link-btn {
  color: #1c1c1c; /* темнее для контраста */
}

.slides__nav {
  background-color: rgba(0, 0, 0, 0.35);
  color: #fff;
  border: none;
}

.slides__nav:hover {
  background-color: rgba(0, 0, 0, 0.5);
}

header[data-include] {
  min-height: 64px; /* or your actual header height */
}

[data-aos] { opacity: 1 !important; transform: none !important; }

header[data-include] { min-height: 64px; }
footer[data-include] { min-height: 200px; }
.case-page { contain: layout; }